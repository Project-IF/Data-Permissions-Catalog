{{ define "main" }}

{{ $pages := .Pages }}

<header class="hompage-intro grid-container">
  <div class="grid-x grid-padding-x">
    <div class="large-7 small-12 cell">
      <h1>Patterns for practical and ethical uses of data</h1>
    </div>
  </div>
  <div class="grid-x grid-padding-x">
    <div class="large-6 small-12 cell">
      <p>Teams around the world use these to design services and fuel conversations.</p>
    </div>
  </div>
</header>

<hr>

<div class="grid-container">
  <ul class="category-nav">
    <li class="active">
      <a class="view-by-category" href="#">Categories</a>
    </li>
    <li>
      <a class="view-most-recent" href="#">Most Recent</a>
    </li>
    <li>
      <a class="view-alphabetically" href="#">Alphabetical</a>
    </li>
    <li class="push">
      <a class="expand-all" href="#">Expand All</a>
    </li>
  </ul>
</div>


{{ $categories := .Site.GetPage "/categories" }}
{{ range $categories.Params.list_of_categories }}

{{ $patterns := where $pages ".Params.category" "=" .name }}

<!-- Add class to section when toggled -->
<hr>
<section class="grid-container category-list {{ urlize .name }}">
  <div class="category-heading grid-x grid-padding-x">
    <div class="small-12 large-9 cell">
      <h2>{{ .name }} <span>{{ len $patterns }}</span></h2>
      <p>{{ .description }}</p>
    </div>
    <div class="see-more-button-container small-12 large-3 cell">
      <a class="see-more-button" href="#">See more</a>
    </div>
  </div>
  <div class="grid-x grid-padding-x pattern-card-list">
    {{ range $patterns }}
    <div class="large-4 small-12 cell">
      <div onclick="window.location.assign('/patterns/{{ urlize .Params.title }}')" class="pattern-card">
        <div class="pattern-card-image">
          <img src="{{ (index .Params.images 0).url | relURL }}" alt="{{ .Params.alt }}">
        </div>
        <div class="pattern-card-title">
          <a href="/patterns/{{ urlize .Params.title }}">{{ .Params.title }}</a>
          {{ if eq .Params.archived true }}
          <p class="archived">Archived 🗄️</p>
          {{ else if eq .Params.future_pattern true }}
          <p class="future-pattern">Future pattern 🔮</p>
          {{ end }}
        </div>
      </div>
    </div>
    {{ end }}
  </div>

</section>

{{ end }}
{{ end }}
